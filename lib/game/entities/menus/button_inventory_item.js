/** *  button_inventory_item.js *  ----- */ig.module(    'game.entities.menus.button_inventory_item').requires(    'plugins.button.button',    'game.entities.menus.button_weapon_equip',    'game.entities.menus.button_weapon_unequip',    'game.entities.menus.button_inventory_item_use',    'game.entities.menus.button_inventory_item_discard').defines(function() {    "use strict";    ig.global.EntityButton_inventory_item = Button.extend({        index: 0,        animSheet: new ig.AnimationSheet('media/gui/bignewMenu.png', 200, 32),        size: {x: 200, y: 32},        init: function(x, y, settings) {            this.parent(x, y, settings);            this.name = 'btn_inventory_item_' + this.index;            if (ig.game.units[ig.game.activeUnit].unitType === 'player') {                this.iconLeft = ig.game.units[ig.game.activeUnit].item[this.index] !== null ? ig.game.units[ig.game.activeUnit].item[this.index].icon : null;                this.text = [ig.game.units[ig.game.activeUnit].item[this.index] !== null ? ig.game.units[ig.game.activeUnit].item[this.index].name : '----'];                this.textRight = [ig.game.units[ig.game.activeUnit].item[this.index] !== null ? ig.game.units[ig.game.activeUnit].item_uses[this.index] : ''];            }            else if (ig.game.units[ig.game.activeUnit].unitType === 'enemy') {                this.iconLeft = ig.game.targetedUnit.item[this.index] !== null ? ig.game.targetedUnit.item[this.index].icon : null;                this.text = [ig.game.targetedUnit.item[this.index] !== null ? ig.game.targetedUnit.item[this.index].name : '----'];                this.textRight = [ig.game.targetedUnit.item[this.index] !== null ? ig.game.targetedUnit.item_uses[this.index] : ''];            }        },        pressedUp: function() {            // Determine whether active unit is a player or enemy.            if (ig.game.units[ig.game.activeUnit].unitType === 'player') {                // Determine which item is being selected.                ig.game.units[ig.game.activeUnit].selectedItemIndex = this.index;                // Make the item clicked the weapon for possible equipment                  ig.game.units[ig.game.activeUnit].selectedWeapon = ig.game.units[ig.game.activeUnit].item[this.index];                ig.game.units[ig.game.activeUnit].isEquipping = true;                if(typeof ig.game.getEntityByName('btn_weapon_equip') !== 'undefined')                    ig.game.getEntityByName('btn_weapon_equip').kill();                if(typeof ig.game.getEntityByName('btn_inventory_item_use') !== 'undefined')                    ig.game.getEntityByName('btn_inventory_item_use').kill();                if(typeof ig.game.getEntityByName('btn_inventory_item_discard') !== 'undefined')                    ig.game.getEntityByName('btn_inventory_item_discard').kill();                // The selecte item is a valid existing item                if(ig.game.units[ig.game.activeUnit].item[ig.game.units[ig.game.activeUnit].selectedItemIndex] !== null) {                // The selected item was not in unit's inventory slot 0, move item to slot 0 and equip the item                if(ig.game.units[ig.game.activeUnit].selectedItemIndex !== 0) {                    if(ig.game.units[ig.game.activeUnit].item[ig.game.units[ig.game.activeUnit].selectedItemIndex].type === 'equip') {                        // Check if equip button exists. If not spawn it, else do nothing.                        if(typeof ig.game.getEntityByName('btn_weapon_equip') === 'undefined') {                            ig.game.spawnEntity(EntityButton_weapon_equip, ig.game.screen.x + 296, ig.game.screen.y + 32);                        }                    } else if(ig.game.units[ig.game.activeUnit].item[ig.game.units[ig.game.activeUnit].selectedItemIndex].type === 'consumable') {                        // Check if use button exists. If not spawn it, else do nothing.                        if(typeof ig.game.getEntityByName('btn_inventory_item_use') === 'undefined') {                            ig.game.spawnEntity(EntityButton_inventory_item_use, ig.game.screen.x + 296, ig.game.screen.y + 32);                        }                    }                    // The selected item was in the unit's inventory slot 0 (equipped slot), unequip the item                }   else {                    // Check if unequip button exists. If not spawn it, else do nothing.                        if(typeof ig.game.getEntityByName('btn_weapon_equip') === 'undefined') {                            ig.game.spawnEntity(EntityButton_weapon_unequip, ig.game.screen.x + 296, ig.game.screen.y + 32);                        }                    }                // Check if discard button exists. If not spawn it, else do nothing.                    if(typeof ig.game.getEntityByName('btn_inventory_item_discard') === 'undefined') {                        ig.game.spawnEntity(EntityButton_inventory_item_discard, ig.game.screen.x + 296, ig.game.screen.y + 96);                    }                   }            }            else if (ig.game.units[ig.game.activeUnit].unitType !== 'player') {                // Determine which item is being selected.                ig.game.targetedUnit.selectedItemIndex = this.index;                // Make the item clicked the weapon for possible equipment                  ig.game.targetedUnit.selectedWeapon = ig.game.targetedUnit.item[this.index];                ig.game.targetedUnit.isEquipping = true;                if(typeof ig.game.getEntityByName('btn_weapon_equip') !== 'undefined')                    ig.game.getEntityByName('btn_weapon_equip').kill();                if(typeof ig.game.getEntityByName('btn_inventory_item_use') !== 'undefined')                    ig.game.getEntityByName('btn_inventory_item_use').kill();                if(typeof ig.game.getEntityByName('btn_inventory_item_discard') !== 'undefined')                    ig.game.getEntityByName('btn_inventory_item_discard').kill();                // The selecte item is a valid existing item                if(ig.game.targetedUnit.item[ig.game.targetedUnit.selectedItemIndex] !== null) {                // The selected item was not in unit's inventory slot 0, move item to slot 0 and equip the item                if(ig.game.targetedUnit.selectedItemIndex !== 0) {                    if(ig.game.targetedUnit.item[ig.game.targetedUnit.selectedItemIndex].type === 'equip') {                        // Check if equip button exists. If not spawn it, else do nothing.                        if(typeof ig.game.getEntityByName('btn_weapon_equip') === 'undefined') {                            ig.game.spawnEntity(EntityButton_weapon_equip, ig.game.screen.x + 296, ig.game.screen.y + 32);                        }                    } else if(ig.game.targetedUnit.item[ig.game.targetedUnit.selectedItemIndex].type === 'consumable') {                        // Check if use button exists. If not spawn it, else do nothing.                        if(typeof ig.game.getEntityByName('btn_inventory_item_use') === 'undefined') {                            ig.game.spawnEntity(EntityButton_inventory_item_use, ig.game.screen.x + 296, ig.game.screen.y + 32);                        }                    }                    // The selected item was in the unit's inventory slot 0 (equipped slot), unequip the item                }   else {                    // Check if unequip button exists. If not spawn it, else do nothing.                        if(typeof ig.game.getEntityByName('btn_weapon_equip') === 'undefined') {                            ig.game.spawnEntity(EntityButton_weapon_unequip, ig.game.screen.x + 296, ig.game.screen.y + 32);                        }                    }                // Check if discard button exists. If not spawn it, else do nothing.                    if(typeof ig.game.getEntityByName('btn_inventory_item_discard') === 'undefined') {                        ig.game.spawnEntity(EntityButton_inventory_item_discard, ig.game.screen.x + 296, ig.game.screen.y + 96);                    }                   }            }        }    });});